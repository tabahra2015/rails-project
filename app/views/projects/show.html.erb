<%= render 'header' %>

<div class="container">
  <div class="Project-content">
    <div class="row">
      
      <div class="col-lg-6">
        <h2><%= @project.name %> project</h2>
          <div class="btn-style">
            <p><%= link_to "Edit", edit_project_path(@project), class: 'btn-edit' %></p>
            <p>
              <%= link_to "Delete", project_path(@project), 
                          method: :delete, 
                          data: { confirm: "Are you sure you want to delete this project?" }, 
                          class: 'btn-delete' %>
            </p>
          </div>
          <!-- Display the description of the project here -->
          <h2> description:</h2>
          <p class="text-muted" style="font-size: 1.6rem; line-height: 1.6; background-color: white; border: 1px solid #ddd; padding: 10px; border-radius: 8px;">
          <%= @project.description %>
          </p>

          
          </div>
    </div>


   
  </div>
</div>

<hr class="my-5">
<div class="row">
  <div class="col-md-6">
    <h3>Tasks</h3>
    <% @project.tasks.each do |task| %>
      <div class="col-lg-6 task-display-content">
        <div class="task-header-content">
          <p class="task-title h1"><%= task.title %></p>
          <p class="btn-task-edit"><%= link_to "Edit Task", edit_task_path(task) %></p>
        </div>

        <div class="task-status-section">
          <p><strong>Status:</strong> <%= task.status.humanize %></p>
        </div>

        <div class="task-progress-section">
          <p><strong>Progress:</strong> <%= task.progress %>%</p>
        </div>

        <div class="task-project-section">
          <p><strong>Project:</strong> <%= task.project.name if task.project.present? %></p>
        </div>

        <div class="task-description">
          <p><strong>Description:</strong></p>
          <p><%= task.description %></p>
        </div>

        <div class="task-timestamps">
          <p><strong>Created At:</strong> <%= task.created_at.strftime("%B %d, %Y %H:%M") %></p>
          <p><strong>Updated At:</strong> <%= task.updated_at.strftime("%B %d, %Y %H:%M") %></p>
        </div>
      </div>
      <hr>
    <% end %>
  </div>
</div>




<hr class="my-5">
<hr class="my-5">

<div class="row">
  <div class="col-md-6">
    <h3>Reviews</h3>
    <% @project.reviews.each do |review| %>
      <div>
        <% if review.rating.present? %>  <!-- Check if the rating is not nil -->
          <% review.rating.times do %>
            <i class="fas fa-star star-yellow"></i>
          <% end %>
        <% else %>
          <i class="fas fa-star"></i> <!-- If rating is nil, display a default star -->
        <% end %>
    
        <!-- Handle nil created_at -->
        <small><em class="text-muted">
          <% if review.created_at.present? %>
            <%= distance_of_time_in_words_to_now(review.created_at) %> ago
          <% else %>
            <%= "Unknown time" %> <!-- You can replace this with a default message -->
          <% end %>
        </em></small>
        
        <p class="mb-0"><%= review.comment %></p>
        <%= link_to "Delete Review", project_path(@project), class: "btn btn-warning border", data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this review?" } %>
      </div>
      <hr> <!-- Add a horizontal line break -->
    <% end %>
    
  </div>

  <div class="col-md-6">
    <div class="border bg-white rounded p-3">
      <h5>Add your review</h5>
      <%= simple_form_for [@project, @review] do |f| %>
        <%= f.input :comment, placeholder: "Add your review here..." %>
        <label for="rating" class="form-label">Select RatingðŸŒŸ*</label>
        <%= f.input :rating, as: :select, collection: (1..5), required: true, label: false, input_html: { class: "form-select text-warning", data: { controller: "star-rating" } } %>
        <%= f.submit class: "btn btn-success mt-2" %>
      <% end %>
    </div>
  </div>
</div>

